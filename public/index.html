<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metaplanet Valuation Model (MVM) v4.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; transition: background-color 0.3s, color 0.3s; }
        .tab-button { padding: 0.75rem 1.5rem; border-bottom: 3px solid transparent; font-weight: 600; cursor: pointer; transition: all 0.2s ease-in-out; }
        .tab-button.active { color: #60a5fa; border-color: #60a5fa; }
        .tab-button:not(.active):hover { color: #93c5fd; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .section-card { border: 1px solid; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 20px; height: 20px; border-radius: 50%; margin-top: -7px; cursor: pointer; }
        .chart-container { position: relative; width: 100%; max-width: 900px; margin-left: auto; margin-right: auto; height: 350px; }
        
        /* Light Mode */
        body { background-color: #f9fafb; color: #111827; }
        .section-card { background-color: white; border-color: #e5e7eb; }
        .info-bar-item { background-color: white; border-color: #e5e7eb; }
        .highlight-value { color: #2563eb; }
        .subtle-text { color: #6b7280; }
        .header-text { color: #111827; }
        .nav-border { border-color: #e5e7eb; }
        input[type=range] { background-color: #e5e7eb; }
        input[type=range]::-webkit-slider-thumb { background: #2563eb; }
        .dot { transform: translateX(0); transition: transform 0.2s ease-in-out; }

        /* Dark Mode */
        .dark body { background-color: #111827; color: #d1d5db; }
        .dark .section-card { background-color: #1f2937; border-color: #374151; }
        .dark .info-bar-item { background-color: #1f2937; border-color: #374151; }
        .dark .highlight-value { color: #60a5fa; }
        .dark .subtle-text { color: #9ca3af; }
        .dark .header-text { color: #f9fafb; }
        .dark .nav-border { border-color: #374151; }
        .dark input[type=range] { background-color: #374151; }
        .dark input[type=range]::-webkit-slider-thumb { background: #60a5fa; }
        .dark input:checked + .toggle-bg .dot { transform: translateX(100%); }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="mb-6">
            <div class="flex justify-between items-center">
                <div class="text-left"><h1 class="text-3xl md:text-4xl font-extrabold header-text">MVM v4.0</h1><p class="mt-1 text-lg subtle-text">Metaplanet Valuation Suite</p></div>
                <div class="flex items-center"><span class="text-sm font-medium subtle-text mr-3">Dark Mode</span><label for="dark-toggle" class="cursor-pointer"><div class="relative"><input type="checkbox" id="dark-toggle" class="sr-only" checked><div class="block bg-gray-600 w-14 h-8 rounded-full"></div><div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full"></div></div></label></div>
            </div>
        </header>

        <div class="border-b nav-border mb-8">
            <nav class="-mb-px flex justify-center space-x-2 md:space-x-8" aria-label="Tabs">
                <button id="btn-dashboard" class="tab-button active">Dashboard</button>
                <button id="btn-backtest" class="tab-button">Backtesting</button>
                <button id="btn-methodology" class="tab-button">Methodology</button>
            </nav>
        </div>

        <div id="tab-content-dashboard" class="tab-content active">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="lg:col-span-2 space-y-6">
                    <div class="section-card"><h2 class="text-xl font-bold border-b border-gray-200 dark:border-gray-700 pb-2 mb-4 header-text">Projection Output</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-center"><div class="bg-gray-50 dark:bg-gray-800/50 p-4 rounded-lg"><p class="text-md subtle-text">Base Projected Price</p><p id="dash-outputBasePrice" class="text-4xl font-extrabold header-text">...</p></div><div><p class="text-md subtle-text">Final Price (with Overshoot)</p><p id="dash-outputFinalPrice" class="text-4xl font-extrabold highlight-value">...</p></div></div></div>
                    <div class="section-card"><h2 class="text-xl font-bold border-b border-gray-200 dark:border-gray-700 pb-2 mb-4 header-text">Monte Carlo Simulation</h2><div class="text-center mb-6"><button id="runMonteCarloBtn" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition">Run 1,000 Simulations</button></div><div id="mc-results" class="mt-4 grid grid-cols-3 gap-4 text-center hidden"><div class="bg-gray-800 p-3 rounded-lg"><p class="text-xs font-semibold text-red-400">Bear Case (25th %)</p><p id="mc-p25" class="text-xl font-bold header-text"></p></div><div class="bg-gray-800 p-3 rounded-lg"><p class="text-xs font-semibold text-yellow-400">Base Case (Median)</p><p id="mc-p50" class="text-xl font-bold header-text"></p></div><div class="bg-gray-800 p-3 rounded-lg"><p class="text-xs font-semibold text-green-400">Bull Case (75th %)</p><p id="mc-p75" class="text-xl font-bold header-text"></p></div></div><p id="mc-range" class="text-center text-xs subtle-text mt-2 hidden"></p></div>
                    <div class="section-card"><h2 class="text-xl font-bold border-b border-gray-200 dark:border-gray-700 pb-2 mb-4 header-text">Sample BTC Price Paths</h2><div class="chart-container"><canvas id="mcPathsChart"></canvas></div></div>
                </div>
                <div class="space-y-6">
                    <div class="section-card space-y-4"><h2 class="text-xl font-bold header-text">Model Inputs</h2>
                        <div><label class="font-medium text-sm subtle-text">Future BTC Target Price</label><span id="dash-btcTargetDisplay" class="float-right font-mono text-sm subtle-text"></span><input type="range" id="dash-btcTargetSlider" min="100000" max="500000" value="225000" step="1000" class="w-full h-2 rounded-lg appearance-none"></div>
                        <div><label class="font-medium text-sm subtle-text">Future BTC Holdings</label><span id="dash-btcHoldingsDisplay" class="float-right font-mono text-sm subtle-text"></span><input type="range" id="dash-btcHoldingsSlider" min="10000" max="250000" value="180000" step="1000" class="w-full h-2 rounded-lg appearance-none"></div>
                        <div><label class="font-medium text-sm subtle-text">Acquisition mNAV</label><span id="dash-acquisitionMnavDisplay" class="float-right font-mono text-sm subtle-text"></span><input type="range" id="dash-acquisitionMnavSlider" min="3" max="15" value="8" step="0.5" class="w-full h-2 rounded-lg appearance-none"></div>
                        <div><label class="font-medium text-sm subtle-text">BTC Annual Volatility</label><span id="dash-volatilityDisplay" class="float-right font-mono text-sm subtle-text"></span><input type="range" id="dash-volatilitySlider" min="0.3" max="1.2" value="0.7" step="0.05" class="w-full h-2 rounded-lg appearance-none"></div>
                        <div><label class="font-medium text-sm subtle-text">Speculative Overshoot</label><span id="dash-overshootDisplay" class="float-right font-mono text-sm subtle-text"></span><input type="range" id="dash-overshootSlider" min="1" max="2" value="1.2" step="0.05" class="w-full h-2 rounded-lg appearance-none"></div>
                        <div id="dash-factorInputsContainer" class="space-y-3 pt-2"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-content-backtest" class="tab-content">
             <div class="space-y-8">
                <div class="section-card"><h2 class="text-2xl font-bold text-center header-text">Historical Premium to NAV</h2><div class="chart-container mt-6"><canvas id="premiumChart"></canvas></div></div>
                <div class="section-card"><h2 class="text-2xl font-bold text-center header-text">Model Backtest (Jan 2025 - Jun 2025)</h2><div class="mt-6 flow-root"><table class="min-w-full divide-y divide-gray-700"><thead class="bg-gray-800"><tr><th class="px-3 py-3.5 text-left text-sm font-semibold header-text">Date</th><th class="px-3 py-3.5 text-left text-sm font-semibold header-text">Actual Price</th><th class="px-3 py-3.5 text-left text-sm font-semibold header-text">NAV</th><th class="px-3 py-3.5 text-left text-sm font-semibold header-text">Implied Price</th><th class="px-3 py-3.5 text-left text-sm font-semibold header-text">Error %</th></tr></thead><tbody id="backtestTableBody" class="divide-y divide-gray-700"></tbody></table></div></div>
            </div>
        </div>

        <div id="tab-content-methodology" class="tab-content">
             <div id="methodology-container" class="section-card prose prose-invert max-w-none"></div>
        </div>
    </div>
    
    <script type="module" src="../src/js/main.js"></script>
</body>
</html>

